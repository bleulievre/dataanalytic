setwd("~/Desktop/data analytic/project")library(dplyr)# Read the datas population_info <- read.csv('Population Info.csv')  #this data comes from the 1000 genome #take a look at the datapopulation_info#keep only the Sample.Name, sex, Superpopulation.name and Population.Name columnpopulation_info <- select(population_info, Sample.name, Population.name,Sex,Superpopulation.name)# Removing rows that are completely emptypopulation_info <- population_info[rowSums(is.na(population_info) | population_info == "") != ncol(population_info), ]#rename the Superpopulation.name column population_info <- rename(population_info, Ancestry = Superpopulation.name)#Read the second data population_country <- read.csv('Population-Country.csv') # I found the country name or region name for each data #glance the second data str(population_country)# Merge the two data framesinfo_country <- merge(population_info, population_country, by.x = "Population.name", by.y = "Population", all.x = TRUE)#read the data of genetic data genetic_data<-read.csv("genetic data.csv",header = FALSE)#glance the third data str(genetic_data)#transpose the data genetic_data <- as.data.frame(t(genetic_data),header = TRUE)#set the first row as header# Assuming your dataframe is named 'my_dataframe'# Set the first row as the headercolnames(genetic_data) <- as.character(unlist(genetic_data[1, ]))# Remove the first row from the dataframegenetic_data <- genetic_data[-1, ]# Remove the first eight rowsgenetic_data <- genetic_data[-(1:9), ]#change the first column name as Sample.namecolnames(genetic_data)[1] <- "Sample.name"#convert the genetic information to Gene Type#0|0->0 wild type homogeneous dominant two reference alleles, no alternative allele#1|0 and 0|1->1 1: heterogeneous (one reference allele , one alternative allele)#1|1->2: homogeneous recessive (two alternative allele)# Function to convert the genetic informationconvert_genotype <- function(genotype) {  if (genotype == "0|0") {    return("0")  } else if (genotype == "1|0" || genotype == "0|1") {    return("1")  } else if (genotype == "1|1") {    return("2")  } else {    return(genotype) # Return the original value if it doesn't match any condition  }}# Apply the function to every column containing genotype informationfor(column_name in colnames(genetic_data)[-1]) { # Skipping the first column  genetic_data[[column_name]] <- sapply(genetic_data[[column_name]], convert_genotype)}#count how many 0, 1, and 2 in each row # Function to count occurrences of 0, 1, and 2 in a rowcount_values <- function(row) {  wild_type <- sum(row == "0" | row == 0) # Count zeros  heterogeneous <- sum(row == "1" | row == 1) # Count ones  recessive <- sum(row == "2" | row == 2) # Count twos  return(c(wild_type = wild_type, heterogeneous = heterogeneous, recessive = recessive))}# Apply the function to each row and transpose the resultcounts <- t(apply(genetic_data, 1, count_values))# Add the results as new columns to the genetic_datagenetic_data$wild_type <- counts[,"wild_type"]genetic_data$heterogeneous <- counts[,"heterogeneous"]genetic_data$recessive <- counts[,"recessive"]#merge the genetic_data with info_country data genetic_info_country <- merge(info_country, genetic_data, by = "Sample.name", all.y = TRUE)#EDA process foo genetic_info_countrysummary(genetic_info_country)#in total there are 2504 data points in this data unique(genetic_info_country$Country_Region)#19 countries in total #make a ggplot to visualize the result library(tidyr)library(ggplot2)# Reshape the data to long formatlong_data <- pivot_longer(genetic_info_country, cols = c(wild_type, heterogeneous, recessive),                          names_to = "genetic_type", values_to = "count")# Create a new data frame to hold the labelslabel_data <- long_data %>%  group_by(Country_Region, genetic_type) %>%  summarize(max_count = max(count)) %>%  ungroup()# Create the grouped bar plotggplot(long_data, aes(x = Country_Region, y = count, fill = genetic_type)) +  geom_bar(stat = "identity", position = position_dodge(width = 0.75)) +  geom_text(data = label_data, aes(label = max_count, y = max_count),             position = position_dodge(width = 0.75),             vjust = -0.5, size = 3, color = "black") +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +  labs(fill = "Genetic Type", y = "Count", x = "Country",        title = "Counts of Genetic Types by Country")#alternative allele is more meaningful to analyze #so for recessive Italy, Kenya, Puerto Rico and United Kingdom are the highest #need to pay attention, Russia has extremely low value #so for heterogenous South Asia and United Kingdom are the highest#Peru and Russia are the lowest #the wild type value are the highest one for all countries #so Russia may not have high height value #need to compare with the genetic data #also zoom in the genes long_data <- pivot_longer(genetic_info_country, cols = c(ADCY3, ADGRG6, ATXN3,GDF5,`H1-3`,HMGA2,LIN28B,MARK3,MTCH2,TRIP11),                          names_to = "genetic_type", values_to = "count")# Create a new data frame to hold the labelslabel_data <- long_data %>%  group_by(Country_Region, genetic_type) %>%  summarize(max_count = max(count)) %>%  ungroup()# Create the grouped bar plotggplot(long_data, aes(x = Country_Region, y = count, fill = genetic_type)) +  geom_bar(stat = "identity", position = position_dodge(width = 0.75)) +  geom_text(data = label_data, aes(label = max_count, y = max_count),             position = position_dodge(width = 0.75),             vjust = -0.5, size = 3, color = "black") +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +  labs(fill = "Genetic Type", y = "Count", x = "Country",        title = "Counts of Genetic Types by Country")#the result can't really see different#so counting how many 0,1,2 in the row is necessary #read the data of heightheight<-read.csv("Height.csv")#glance the height data str(height)#take a look at the age range range(height$Age.group)#select only the age at 19 height<-height%>%  filter(Age.group==19)#keep the only first four columns height<-height[,(1:5)]#EDA process for height summary(height)#14000 data points in total unique(height$Country)#199 countries in this list #this represent some countries may not on the list of the genetic # Filter the height  data to keep only the countries in the population-country dataheight <- height %>%  filter(Country %in% population_country$Country_Region)unique(height$Country)#now is only 38#shrinking the data str(height)# Create a new data frame with the mean height for each country (ignoring year)mean_height_by_country <- aggregate(Mean.height ~ Country, data = height, FUN = mean)# Create a bar chartggplot(mean_height_by_country, aes(x = Country, y = Mean.height)) +  geom_bar(stat = "identity", fill = "blue") +  labs(title = "Mean Height by Country (Ignoring Year)",       x = "Country",       y = "Mean.height") +  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for readability#all country have average height does greater than 150#some are really high range(height$Mean.height)#the range goes from 150.2548 to 182.7907 # Assuming you have a data frame named height_data with columns "Country" and "Mean_Height"# Find the row index of the maximum heightmax_index <- which.max(height$Mean.height)# Find the row index of the minimum heightmin_index <- which.min(height$Mean.height)# Get the corresponding country namescountry_with_max_height <- height$Country[max_index]country_with_min_height <- height$Country[min_index]# Print the resultsprint(country_with_max_height)print(country_with_min_height)#the country with highest height is Estonia, which is a European country #the country with lowest height is Philippines, which is a Asian country #read the food datanutrition<-read.csv("Food.csv")#glance the food datastr(nutrition)#select useful variables #since select function won't work for character #it's necessary to convert them nutrition<-nutrition%>%  select(Area, Item, Element, Year, Unit, Value)#EDA process for nutrtion unique(nutrition$Area)#220 countries summary(nutrition)#253188 data point #only keep these four categories in the element column #Protein and Fat Supply (Daily Intake):#Referring to "Protein supply quantity (g/capita/day "and "Fat supply quantity (g/capita/day) )"#reflect the nutritional profile of a population.#Protein intake, in particular, is a crucial factor for growth and development.#Caloric Intake:#Referring to "Food supply (kcal/capita/day)" represents the energy availability for the population#Energy intake is essential for growth, especially in developing countries#where undernutrition can limit height.#Food Supply Quantity (Annual):#Referring to "Food supply quantity (kg/capita/yr)" #measures the overall food availability within a country, #which may correlate with economic status and general nutrition.nutrition <- nutrition %>%  filter(Element %in% c("Protein supply quantity (g/capita/day)",                        "Fat supply quantity (g/capita/day)",                        "Food supply (kcal/capita/day)",                        "Food supply quantity (kg/capita/yr)"))#check the filter result unique(nutrition$Element)unique(nutrition$Item)#116 items#visualize a example result #only take a look at the Grand total of  food supply quantity grand_total <- nutrition %>%  filter(Element == "Food supply (kcal/capita/day)")%>%  filter(Item =="Grand Total")# Create a new data frame as well  (ignoring year)# Sort the mean_grand data frame by Value in descending ordermean_grand_sorted <- mean_grand[order(mean_grand$Value, decreasing = TRUE), ]# Select the top 10 countriestop_10 <- head(mean_grand_sorted, 10)# Create a bar chart for the top 10 countriesggplot(top_10, aes(x = reorder(Area, Value), y = Value)) +  geom_bar(stat = "identity", fill = "blue") +  labs(title = "Top 10 Mean Food Supply by Country (Ignoring Year)",       x = "Country",       y = "Value") +  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # the top country in this top ten are Austria,Ireland, Northern America, USA and Belgium #now take a look at the last 10 tail_10 <- tail(mean_grand_sorted, 10)# Create a bar chart for the top 10 countriesggplot(tail_10, aes(x = reorder(Area, Value), y = Value)) +  geom_bar(stat = "identity", fill = "blue") +  labs(title = "Tail 10 Mean Food Supply by Country (Ignoring Year)",       x = "Country",       y = "Value") +  theme(axis.text.x = element_text(angle = 45, hjust = 1)) #the tail country in the tail ten are Burundi, Central Africa and Republic Madgascar #take a look at the range of the year for both food and height datarange(nutrition$Year)#2010-2020range(height$Year)#1985-2019#therefore, the year value need to adjust#we want only year greater than 2010 in the height data to match with the food data height<-height%>%  filter(Year>2010)# Filter the nutrition  data to keep only the countries in the population-country datanutrition <- nutrition %>%  filter(Area %in% population_country$Country_Region)#the food data is still too huge #so separate the data into four sub-data basing on the element content #before separating the data, changing the Area to Country nutrition <- rename(nutrition, Country = Area)# Assuming you have a data frame named "nutrition"# Create 37 new columns for each unique item and initialize them to NAunique_items <- unique(nutrition$Item)for (item in unique_items) {  col_name <- make.names(item)  # Create valid column name  nutrition[, col_name] <- NA}# Populate the columns with their respective valuesfor (i in 1:nrow(nutrition)) {  item <- nutrition$Item[i]  value <- nutrition$Value[i]  nutrition[i, make.names(item)] <- value}#replace the NA with 0nutrition[is.na(nutrition)] <- 0Protein<-nutrition%>%  filter(Element %in% "Protein supply quantity (g/capita/day)")Fat<-nutrition%>%  filter(Element %in% "Fat supply quantity (g/capita/day)")Calory<-nutrition%>%  filter(Element%in% "Food supply (kcal/capita/day)")Food<-nutrition%>%  filter(Element %in% 'Food supply quantity (kg/capita/yr)')#split the genetic_info_country data to male and femaleGenetic_male<-genetic_info_country%>%  filter(Sex %in% "male")Genetic_female<-genetic_info_country%>%  filter(Sex %in% "female")#separate the height data to male and female#before separarting the data, changing the Boys to male and Girls to female height <- height %>%  mutate(Sex = case_when(    Sex == "Boys"  ~ "male",    Sex == "Girls" ~ "female",    TRUE           ~ Sex    ))#separate the height data to male and female height_male<-height%>%  filter(Sex %in% 'male') height_female<-height%>%  filter(Sex %in% 'female')#merge protein and height data together and remove NAsprotein_height <- merge(height, Protein, by = c("Year", "Country"), all = TRUE)%>%  na.omit(protein_height)X <- protein_height[, 8:44]X <- X[, sapply(X, function(col) length(unique(col)) > 1)]Y <- protein_height$Mean.height# Perform linear regressionlm_model <- lm(Y ~ ., data = cbind(X, Y))# View the summary of the regression modelsummary(lm_model)#the p value is smaller than 0.05 #there's a significant relationship between mean.height and those variables #however, the r sqaured values is very low, the result may be biased model_summary <- summary(lm_model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05significant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05]# Print the significant variablesprint(significant_vars)#"Oats," "Millet and products," "Cereals, Other," "Cassava and products," #"Sweet potatoes," "Yams," "Roots, Other," "Sugar Crops," "Sugar and Sweeteners," #"Sugar cane," "Sugar non-centrifugal," "Honey," "Peas," "Treenuts," "Nuts and products," #and "Soyabeans" exhibit significant relationships with the response variable.#however, the r sqaured values is very low, the result may be biased #try pca to see the result library(readr)library(stats)# Selecting only numeric columnsnumeric_columns <- sapply(protein_height, is.numeric)data_numeric <- protein_height[, numeric_columns]# Identify and remove columns with zero or constant variancevariance_non_zero <- apply(data_numeric, 2, var) != 0data_no_constant <- data_numeric[, variance_non_zero]# Standardize the datadata_scaled <- scale(data_no_constant)# Perform PCApca_result <- prcomp(data_scaled, center = TRUE, scale. = TRUE)# Summary of PCA resultssummary(pca_result)# Plot PCA (optional)plot(pca_result, type = "lines")#pc 1 and 2 are higher than the rest loadings <- pca_result$rotation# View the loadingsprint(loadings)biplot(pca_result)#pca returned a different kinds of result#the most relevant product are vegetal products, animal products and cereals...excluding beer #the result is different from regression #try it on the fat and height data to see, if the same thing happens with fat and height #merge fat and height data together and remove NAsfat_height <- merge(height,Fat, by = c( "Year","Country"), all = TRUE )%>%  na.omit(fat_height)X <- fat_height[, 8:44]X <- X[, sapply(X, function(col) length(unique(col)) > 1)]Y <- fat_height$Mean.height# Perform linear regressionlm_model <- lm(Y ~ ., data = cbind(X, Y))# View the summary of the regression modelsummary(lm_model)#the p value is smaller than 0.05 #there's a significant relationship between mean.height and those variables model_summary <- summary(lm_model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05significant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05]# Print the significant variablesprint(significant_vars)#"Rice and products," "Barley and products," "Maize and products," "Rye and products," #"Oats," "Millet and products," "Starchy Roots," "Cassava and products," #"Potatoes and products," "Sweet potatoes," "Roots, Other," "Sugar Crops,"#"Sugar and Sweeteners," "Sugar cane," "Sweeteners, Other," "Sugar non-centrifugal,"#"Peas," "Treenuts," and "Nuts and products," as having significant relationships with #the response variable.#however, the r squared values is very low, the result may be biased library(readr)library(stats)# Selecting only numeric columnsnumeric_columns <- sapply(fat_height, is.numeric)data_numeric <- fat_height[, numeric_columns]# Identify and remove columns with zero or constant variancevariance_non_zero <- apply(data_numeric, 2, var) != 0data_no_constant <- data_numeric[, variance_non_zero]# Standardize the datadata_scaled <- scale(data_no_constant)# Perform PCApca_result <- prcomp(data_scaled, center = TRUE, scale. = TRUE)# Summary of PCA resultssummary(pca_result)# Plot PCA (optional)plot(pca_result, type = "lines")#pc 1 and 2 are higher than the rest loadings <- pca_result$rotation# View the loadingsprint(loadings)#still vegetal products and animal products biplot(pca_result)#take look if the same thing happens #merge calory and height data together and remove NAscalory_height <- merge(height, Calory, by = c("Year","Country"), all= TRUE) %>%  na.omit(calory_height)X <- calory_height[, 8:44]X <- X[, sapply(X, function(col) length(unique(col)) > 1)]Y <- calory_height$Mean.height# Perform linear regressionlm_model <- lm(Y ~ ., data = cbind(X, Y))# View the summary of the regression modelsummary(lm_model)#the p value is smaller than 0.05 #there's a significant relationship between mean.height and those variables model_summary <- summary(lm_model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05significant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05]# Print the significant variablesprint(significant_vars)#"Oats," "Millet and products," "Cereals, Other," "Cassava and products,#" "Sweet potatoes," "Roots, Other," "Sugar Crops," "Sugar cane," "Honey," #"Peas," "Treenuts," "Nuts and products," and "Soyabeans," exhibit significant #relationships with the response variable.library(readr)library(stats)# Selecting only numeric columnsnumeric_columns <- sapply(calory_height, is.numeric)data_numeric <- calory_height[, numeric_columns]# Identify and remove columns with zero or constant variancevariance_non_zero <- apply(data_numeric, 2, var) != 0data_no_constant <- data_numeric[, variance_non_zero]# Standardize the datadata_scaled <- scale(data_no_constant)# Perform PCApca_result <- prcomp(data_scaled, center = TRUE, scale. = TRUE)# Summary of PCA resultssummary(pca_result)# Plot PCA (optional)plot(pca_result, type = "lines")#pc 1 and 2 are higher than the rest loadings <- pca_result$rotation# View the loadingsprint(loadings)#only vegetal products biplot(pca_result)#merge food and height data together and remove NAsfood_height <-merge(height, Food, by = c("Year","Country"), all = TRUE) %>%  na.omit(food_height)X <- food_height[, 8:44]X <- X[, sapply(X, function(col) length(unique(col)) > 1)]Y <- food_height$Mean.height# Perform linear regressionlm_model <- lm(Y ~ ., data = cbind(X, Y))# View the summary of the regression modelsummary(lm_model)#the p value is smaller than 0.05 #there's a significant relationship between mean.height and those variables model_summary <- summary(lm_model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05significant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05]# Print the significant variablesprint(significant_vars)# "Oats," "Cereals, Other," "Honey," "Peas," "Nuts and products," and "Soyabeans,"#have significant relationships with the response variable.library(readr)library(stats)# Selecting only numeric columnsnumeric_columns <- sapply(food_height, is.numeric)data_numeric <- food_height[, numeric_columns]# Identify and remove columns with zero or constant variancevariance_non_zero <- apply(data_numeric, 2, var) != 0data_no_constant <- data_numeric[, variance_non_zero]# Standardize the datadata_scaled <- scale(data_no_constant)# Perform PCApca_result <- prcomp(data_scaled, center = TRUE, scale. = TRUE)# Summary of PCA resultssummary(pca_result)# Plot PCA (optional)plot(pca_result, type = "lines")#pc 1 and 2 are higher than the rest loadings <- pca_result$rotation# View the loadingsprint(loadings)#returns the cereals... excluding beer, wheat and products and rice and products biplot(pca_result)#same process for male_height genetic_info_country <- rename(genetic_info_country, Country = Country_Region)#merge genetic and height together and remove NAsgenetic_height <-merge(genetic_info_country,height, by= "Country", all = TRUE)%>%  na.omit(genetic_height)model<-lm(Mean.height~wild_type+heterogeneous+recessive,genetic_height)summary(model)#the p value is all smaller than significant level#the p value of the model is small as well. #there's significant relationship between height and genes #however, the r squared  is extremely small#recessive showed NA #that means there is multicollinearity issue#that means there exists correlation between predictor #it may because include the wild type #if we removed wild type will the model better? model<-lm(Mean.height~heterogeneous+recessive,genetic_height)summary(model)#the r squared is still extremelty small#but the recessive is not NAs.#what if consider sex as a factor #separate into different sex#merge genetic_male and height_male together and remove NAs genetic_height_male <-merge(Genetic_male,height_male, by = "Country" , all= TRUE)%>%  na.omit(genetic_height_male)model<-lm(Mean.height~heterogeneous+recessive,genetic_height_male)summary(model)#the R squared did improve but still very low genetic_height_female <-merge(Genetic_female,height_female, by = "Country" , all= TRUE)%>%  na.omit(genetic_height_female)model<-lm(Mean.height~heterogeneous+recessive,genetic_height_female)summary(model)#same thing happen for female #it may because little predict variable in the model #what if involve nutrition variable in it #merge protein and genetic together and remove NAsprotein_genetic <-merge(Protein,genetic_info_country,by ="Country", all=TRUE)%>%  na.omit(protein_genetic)# Creating a new response variable by summing 'heterogeneous' and 'recessive'protein_genetic$response <- protein_genetic$heterogeneous + protein_genetic$recessive# Fit a multivariate linear regression model# Using selected predictor variablesmodel <- lm(response ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar.beet + Sugar...Sweeteners +               Sugar.cane + Sugar..Raw.Equivalent. + Sweeteners..Other +               Sugar.non.centrifugal + Honey + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops + Soyabeans + Groundnuts + Sunflower.seed + Rape.and.Mustardseed,             data = protein_genetic)# View the summary of the modelsummary(model)#take out those NAs. model <- lm(response ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops ,             data = protein_genetic)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 significant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05]# Print the significant variablesprint(significant_vars)#"Animal.Products," "Rice.and.products," "Barley.and.products," "Rye.and.products," #"Oats," "Millet.and.products," "Sorghum.and.products," "Cereals..Other," "Starchy.Roots," #"Cassava.and.products," "Potatoes.and.products," "Sweet.potatoes," "Yams," "Roots..Other," #"Sugar.Crops," "Sugar...Sweeteners," "Sugar.cane," "Sugar.non.centrifugal," "Pulses," "Beans,"#"Peas," "Pulses..Other.and.products," "Treenuts," "Nuts.and.products," and "Oilcrops,"#howerver, things need to cautious is that the r squared value still extremely small#since protein does not have sex column, so not necessary to split into two sexs #merge fat and genetic together and remove NAsfat_genetic<-merge(Fat,genetic_info_country,by="Country",all=TRUE)%>%  na.omit(fat_genetic)# Creating a new response variable by summing 'heterogeneous' and 'recessive'fat_genetic$response <- fat_genetic$heterogeneous + fat_genetic$recessive# Fit a multivariate linear regression model#remove those NAs ahead of time model <- lm(response ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops ,             data = fat_genetic)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 and not NAssignificant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05 & !is.na(coefficients[, "Pr(>|t|)"])]# Print the significant variablesprint(significant_vars)#"Vegetal.Products," "Animal.Products," "Cereals...Excluding.Beer," #"Wheat.and.products," "Rice.and.products," "Barley.and.products," #"Maize.and.products," "Rye.and.products," "Oats," "Millet.and.products," #"Sorghum.and.products," "Cereals..Other," "Starchy.Roots," "Cassava.and.products,"#"Potatoes.and.products," "Sweet.potatoes," "Yams," "Roots..Other," "Sugar.Crops," #"Sugar...Sweeteners," "Sugar.cane," "Sugar.non.centrifugal," "Pulses," "Beans," #"Peas," "Pulses..Other.and.products," "Treenuts," "Nuts.and.products," and "Oilcrops," #three more variables than protein_genetic#merge calory and genetic together and remove NAscalory_genetic<-merge(Calory,genetic_info_country,by="Country",all=TRUE)%>%  na.omit(calory_genetic)# Creating a new response variable by summing 'heterogeneous' and 'recessive'calory_genetic$response <- calory_genetic$heterogeneous + calory_genetic$recessive# Fit a multivariate linear regression model#remove those NAs ahead of time model <- lm(response ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops ,             data = calory_genetic)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 and not NAssignificant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05 & !is.na(coefficients[, "Pr(>|t|)"])]# Print the significant variablesprint(significant_vars)#"Animal.Products," "Cereals...Excluding.Beer," "Rice.and.products," "Barley.and.products,"#"Rye.and.products," "Oats," "Millet.and.products," "Sorghum.and.products," "Cereals..Other,"#"Starchy.Roots," "Cassava.and.products," "Potatoes.and.products," "Sweet.potatoes," "Yams,"#"Roots..Other," "Sugar.Crops," "Sugar...Sweeteners," "Sugar.cane," "Sugar.non.centrifugal," #"Pulses," "Beans," "Peas," "Pulses..Other.and.products," "Treenuts," "Nuts.and.products," #and "Oilcrops,"#merge food and genetic together and remove NAsfood_genetic<-merge(Food,genetic_info_country,by="Country",all=TRUE)%>%  na.omit(food_genetic)# Creating a new response variable by summing 'heterogeneous' and 'recessive'food_genetic$response <- food_genetic$heterogeneous + food_genetic$recessive# Fit a multivariate linear regression model#remove those NAs ahead of time model <- lm(response ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops ,             data = food_genetic)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 and not NAssignificant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05 & !is.na(coefficients[, "Pr(>|t|)"])]# Print the significant variablesprint(significant_vars)#"Cereals...Excluding.Beer," "Rice.and.products," "Barley.and.products," "Rye.and.products," #"Oats," "Millet.and.products," "Sorghum.and.products," "Cereals..Other," "Starchy.Roots," #"Cassava.and.products," "Potatoes.and.products," "Sweet.potatoes," "Yams," "Roots..Other," #"Sugar.Crops," "Sugar...Sweeteners," "Sugar.cane," "Sugar.non.centrifugal," "Pulses," "Beans,#" "Peas," "Pulses..Other.and.products," "Treenuts," "Nuts.and.products," and "Oilcrops,"#this time include nutrtion, height and genetic together #merge protein_height and genetic togetherprotein_height_genetic<-merge(protein_height,genetic_info_country,by="Country",all=TRUE)%>%  na.omit(protein_height_genetic)model <- lm(Mean.height ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops+recessive+heterogeneous ,             data = protein_height_genetic)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 and not NAssignificant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05 & !is.na(coefficients[, "Pr(>|t|)"])]# Print the significant variablesprint(significant_vars)#the result proved that not only nutrtion, genetic also have significant relationship with height #"Vegetal.Products," "Animal.Products," "Cereals...Excluding.Beer," "Wheat.and.products," #"Barley.and.products," "Maize.and.products," "Rye.and.products," "Oats," "Millet.and.products," #"Sorghum.and.products," "Starchy.Roots," "Cassava.and.products," "Sweet.potatoes," "Yams," #"Roots..Other," "Sugar.Crops," "Sugar...Sweeteners," "Sugar.cane," "Sugar.non.centrifugal," #"Pulses," "Beans," "Peas," "Pulses..Other.and.products," "Treenuts," "Nuts.and.products," #"Oilcrops," and also genetic factors like "recessive" and "heterogeneous," #since genetic and height both have sex column, taking that concernprotein_height_male <- merge(height_male, Protein, by = c("Year", "Country"), all = TRUE)%>%  na.omit(protein_height_male)protein_height_geneitc_male<-merge(protein_height_male,Genetic_male,by="Country",all=TRUE)%>%  na.omit(protein_height_geneitc_male)model <- lm(Mean.height ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops+recessive+heterogeneous ,             data = protein_height_geneitc_male)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 significant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05 & !is.na(coefficients[, "Pr(>|t|)"])]# Print the significant variablesprint(significant_vars)#"Vegetal.Products," "Animal.Products," "Cereals...Excluding.Beer," "Wheat.and.products,#" "Rice.and.products," "Barley.and.products," "Maize.and.products," "Rye.and.products," #"Oats," "Millet.and.products," "Sorghum.and.products," "Cereals..Other," "Starchy.Roots," #"Cassava.and.products," "Sweet.potatoes," "Yams," "Roots..Other," "Sugar.Crops," #"Sugar...Sweeteners," "Sugar.cane," "Sugar.non.centrifugal," "Pulses," "Beans," "Peas,"#"Pulses..Other.and.products," "Treenuts," "Nuts.and.products," "Oilcrops," and genetic factors #like "recessive" and "heterogeneous." protein_height_female <- merge(height_female, Protein, by = c("Year", "Country"), all = TRUE)%>%  na.omit(protein_height_female)protein_height_geneitc_female<-merge(protein_height_female,Genetic_female,by="Country",all=TRUE)%>%  na.omit(protein_height_geneitc_female)model <- lm(Mean.height ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops+recessive+heterogeneous ,             data = protein_height_geneitc_female)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 significant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05 & !is.na(coefficients[, "Pr(>|t|)"])]# Print the significant variablesprint(significant_vars)# "Vegetal.Products," "Animal.Products," "Cereals...Excluding.Beer," "Wheat.and.products," #"Barley.and.products," "Maize.and.products," "Rye.and.products," "Oats," "Millet.and.products," #"Sorghum.and.products," "Starchy.Roots," "Cassava.and.products," "Yams," "Roots..Other," #"Sugar.Crops," "Sugar...Sweeteners," "Sugar.cane," "Sugar.non.centrifugal," "Pulses," #"Beans," "Pulses..Other.and.products," "Treenuts," "Nuts.and.products," "Oilcrops," #and genetic factors such as "recessive" and "heterogeneous." #merge fat_height and genetic togetherfat_height_genetic<-merge(fat_height,genetic_info_country,by="Country",all=TRUE)%>%  na.omit(fat_height_genetic)model <- lm(Mean.height ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops+recessive+heterogeneous ,             data = fat_height_genetic)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 and not NAssignificant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05 & !is.na(coefficients[, "Pr(>|t|)"])]# Print the significant variablesprint(significant_vars)#the result proved that not only nutrtion, genetic also have significant relationship with height #"Animal.Products," "Cereals...Excluding.Beer," "Wheat.and.products," "Rice.and.products," #"Maize.and.products," "Rye.and.products," "Oats," "Millet.and.products," "Sorghum.and.products,#" "Cereals..Other," "Starchy.Roots," "Cassava.and.products," "Potatoes.and.products," #"Sweet.potatoes," "Yams," "Roots..Other," "Sugar.Crops," "Sugar.cane," "Pulses," "Beans,#" "Peas," "Pulses..Other.and.products," "Treenuts," "Nuts.and.products," and "Oilcrops,#" along with genetic factors "recessive" and "heterogeneous." #since genetic and height both have sex column, taking that concernfat_height_male <- merge(height_male, Fat, by = c("Year", "Country"), all = TRUE)%>%  na.omit(fat_height_male)fat_height_geneitc_male<-merge(fat_height_male,Genetic_male,by="Country",all=TRUE)%>%  na.omit(fat_height_geneitc_male)model <- lm(Mean.height ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops+recessive+heterogeneous ,             data = fat_height_geneitc_male)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 significant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05 & !is.na(coefficients[, "Pr(>|t|)"])]# Print the significant variablesprint(significant_vars)#" "Animal.Products," "Cereals...Excluding.Beer," "Wheat.and.products,#" "Rice.and.products," "Barley.and.products," "Maize.and.products," "Rye.and.products," #"Oats," "Millet.and.products," "Sorghum.and.products," "Cereals..Other," "Starchy.Roots," #"Cassava.and.products," "Sweet.potatoes," "Yams," "Roots..Other," "Sugar.Crops," #"Sugar...Sweeteners," "Sugar.cane," "Sugar.non.centrifugal," "Pulses," "Beans," "Peas,"#"Pulses..Other.and.products," "Treenuts," "Nuts.and.products," "Oilcrops," and genetic factors #like "recessive" and "heterogeneous." fat_height_female <- merge(height_female, Fat, by = c("Year", "Country"), all = TRUE)%>%  na.omit(fat_height_female)fat_height_geneitc_female<-merge(fat_height_female,Genetic_female,by="Country",all=TRUE)%>%  na.omit(fat_height_geneitc_female)model <- lm(Mean.height ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops+recessive+heterogeneous ,             data = fat_height_geneitc_female)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 significant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05 & !is.na(coefficients[, "Pr(>|t|)"])]# Print the significant variablesprint(significant_vars)# "Animal.Products," "Cereals...Excluding.Beer," "Wheat.and.products," #"Barley.and.products," "Maize.and.products," "Rye.and.products," "Oats," "Millet.and.products," #"Sorghum.and.products," "Starchy.Roots," "Cassava.and.products," "Yams," "Roots..Other," #"Sugar.Crops," "Sugar...Sweeteners," "Sugar.cane," "Sugar.non.centrifugal," "Pulses," #"Beans," "Pulses..Other.and.products," "Treenuts," "Nuts.and.products," "Oilcrops," #and genetic factors such as "recessive" and "heterogeneous." #merge fat_height and genetic togethercalory_height_genetic<-merge(calory_height,genetic_info_country,by="Country",all=TRUE)%>%  na.omit(calory_height_genetic)model <- lm(Mean.height ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops+recessive+heterogeneous ,             data = calory_height_genetic)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 and not NAssignificant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05 & !is.na(coefficients[, "Pr(>|t|)"])]# Print the significant variablesprint(significant_vars)#the result proved that not only nutrtion, genetic also have significant relationship with height #"Animal.Products," "Cereals...Excluding.Beer," "Wheat.and.products," "Rice.and.products," #"Maize.and.products," "Rye.and.products," "Oats," "Millet.and.products," "Sorghum.and.products,#" "Cereals..Other," "Starchy.Roots," "Cassava.and.products," "Potatoes.and.products," #"Sweet.potatoes," "Yams," "Roots..Other," "Sugar.Crops," "Sugar.cane," "Pulses," "Beans,#" "Peas," "Pulses..Other.and.products," "Treenuts," "Nuts.and.products," and "Oilcrops,#" along with genetic factors "recessive" and "heterogeneous." #since genetic and height both have sex column, taking that concerncalory_height_male <- merge(height_male, Calory, by = c("Year", "Country"), all = TRUE)%>%  na.omit(calory_height_male)calory_height_geneitc_male<-merge(calory_height_male,Genetic_male,by="Country",all=TRUE)%>%  na.omit(calory_height_geneitc_male)model <- lm(Mean.height ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops+recessive+heterogeneous ,             data = calory_height_geneitc_male)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 significant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05 & !is.na(coefficients[, "Pr(>|t|)"])]# Print the significant variablesprint(significant_vars)#" "Animal.Products," "Cereals...Excluding.Beer," "Wheat.and.products,#" "Rice.and.products," "Barley.and.products," "Maize.and.products," "Rye.and.products," #"Oats," "Millet.and.products," "Sorghum.and.products," "Cereals..Other," "Starchy.Roots," #"Cassava.and.products," "Sweet.potatoes," "Yams," "Roots..Other," "Sugar.Crops," #"Sugar...Sweeteners," "Sugar.cane," "Sugar.non.centrifugal," "Pulses," "Beans," "Peas,"#"Pulses..Other.and.products," "Treenuts," "Nuts.and.products," "Oilcrops," and genetic factors #like "recessive" and "heterogeneous." calory_height_female <- merge(height_female, Calory, by = c("Year", "Country"), all = TRUE)%>%  na.omit(calory_height_female)calory_height_geneitc_female<-merge(calory_height_female,Genetic_female,by="Country",all=TRUE)%>%  na.omit(calory_height_geneitc_female)model <- lm(Mean.height ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops+recessive+heterogeneous ,             data = calory_height_geneitc_female)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 significant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05 & !is.na(coefficients[, "Pr(>|t|)"])]# Print the significant variablesprint(significant_vars)# "Animal.Products," "Cereals...Excluding.Beer," "Wheat.and.products," #"Barley.and.products," "Maize.and.products," "Rye.and.products," "Oats," "Millet.and.products," #"Sorghum.and.products," "Starchy.Roots," "Cassava.and.products," "Yams," "Roots..Other," #"Sugar.Crops," "Sugar...Sweeteners," "Sugar.cane," "Sugar.non.centrifugal," "Pulses," #"Beans," "Pulses..Other.and.products," "Treenuts," "Nuts.and.products," "Oilcrops," #and genetic factors such as "recessive" and "heterogeneous." #merge fat_height and genetic togetherfood_height_genetic<-merge(food_height,genetic_info_country,by="Country",all=TRUE)%>%  na.omit(fodd_height_genetic)model <- lm(Mean.height ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops+recessive+heterogeneous ,             data = food_height_genetic)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 and not NAssignificant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05 & !is.na(coefficients[, "Pr(>|t|)"])]# Print the significant variablesprint(significant_vars)#the result proved that not only nutrtion, genetic also have significant relationship with height #"Barley.and.products," "Maize.and.products," "Rye.and.products," "Oats," "Millet.and.products,#" "Sorghum.and.products," "Cereals..Other," "Starchy.Roots," "Cassava.and.products," #"Potatoes.and.products," "Yams," "Roots..Other," "Sugar.Crops," "Sugar.cane," #"Sugar.non.centrifugal," "Pulses," "Beans," "Peas," "Pulses..Other.and.products," #"Treenuts," "Nuts.and.products," "Oilcrops," and a genetic factor "heterogeneous."#since genetic and height both have sex column, taking that concernfood_height_male <- merge(height_male, Food, by = c("Year", "Country"), all = TRUE)%>%  na.omit(food_height_male)food_height_geneitc_male<-merge(food_height_male,Genetic_male,by="Country",all=TRUE)%>%  na.omit(food_height_geneitc_male)model <- lm(Mean.height ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops+recessive+heterogeneous ,             data = food_height_geneitc_male)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 significant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05 & !is.na(coefficients[, "Pr(>|t|)"])]# Print the significant variablesprint(significant_vars)#"Wheat.and.products," "Rice.and.products," "Barley.and.products," "Maize.and.products," #"Rye.and.products," "Oats," "Millet.and.products," "Sorghum.and.products," "Cereals..Other," #"Starchy.Roots," "Cassava.and.products," "Potatoes.and.products," "Yams," "Roots..Other," #"Sugar.Crops," "Sugar.cane," "Sugar.non.centrifugal," "Pulses," "Beans," "Peas," #"Pulses..Other.and.products," "Treenuts," "Nuts.and.products," and "Oilcrops,"#along with genetic factors "recessive" and "heterogeneous." food_height_female <- merge(height_female, Food, by = c("Year", "Country"), all = TRUE)%>%  na.omit(food_height_female)food_height_geneitc_female<-merge(food_height_female,Genetic_female,by="Country",all=TRUE)%>%  na.omit(food_height_geneitc_female)model <- lm(Mean.height ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +               Wheat.and.products + Rice.and.products + Barley.and.products +               Maize.and.products + Rye.and.products + Oats + Millet.and.products +               Sorghum.and.products + Cereals..Other + Starchy.Roots +               Cassava.and.products + Potatoes.and.products + Sweet.potatoes +               Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +               Sugar.cane +               Sugar.non.centrifugal + Pulses + Beans + Peas +               Pulses..Other.and.products + Treenuts + Nuts.and.products +               Oilcrops+recessive+heterogeneous ,             data = food_height_geneitc_female)summary(model)model_summary <- summary(model)# Extracting coefficientscoefficients <- model_summary$coefficients# Finding the variables with p-values less than 0.05 significant_vars <- rownames(coefficients)[coefficients[, "Pr(>|t|)"] < 0.05 & !is.na(coefficients[, "Pr(>|t|)"])]# Print the significant variablesprint(significant_vars)#"Cereals...Excluding.Beer," "Wheat.and.products," "Barley.and.products," #"Maize.and.products," "Rye.and.products," "Oats," "Millet.and.products,"#"Sorghum.and.products," "Cereals..Other," "Starchy.Roots," "Cassava.and.products," #"Potatoes.and.products," "Sweet.potatoes," "Yams," "Roots..Other," "Sugar.Crops,"#"Sugar...Sweeteners," "Sugar.cane," "Sugar.non.centrifugal," "Pulses," "Beans," #"Peas," "Pulses..Other.and.products," "Treenuts," "Nuts.and.products," "Oilcrops," #and genetic factors "recessive" and "heterogeneous." #only food has different result for different sex #protein height genetic result is different from fat height genetic and calory height genetic #even though the r squared  value is very small#use decision trrr to test those model#first protien_height_genetic #since the sex does not affect the result#so just testing the general is fine#only testing those relevant variable #since the model is too big#pick only three variables library(rpart)# Fit a Decision Tree modeldt_model <- rpart(Mean.height ~ Vegetal.Products + Animal.Products + Cereals...Excluding.Beer +                     Wheat.and.products + Barley.and.products +                     Maize.and.products + Rye.and.products + Oats + Millet.and.products +                     Sorghum.and.products + Starchy.Roots +                     Cassava.and.products + Sweet.potatoes +                     Yams + Roots..Other + Sugar.Crops + Sugar...Sweeteners +                     Sugar.cane + Sugar.non.centrifugal + Pulses + Beans + Peas +                     Pulses..Other.and.products + Treenuts + Nuts.and.products +                     Oilcrops + recessive + heterogeneous,                   data = protein_height_genetic,                  control = rpart.control(cp = 0.001, minsplit = 20))  # Adjust cp and minsplit as neededsummary(dt_model)#the result is "heterogeneous," "recessive," "Wheat.and.products," "Starchy.Roots,"#"Nuts.and.products," "Treenuts," "Oilcrops," "Oats," "Rye.and.products," "Animal.Products,"#"Pulses..Other.and.products," "Cereals...Excluding.Beer," "Maize.and.products," #"Cassava.and.products," and "Pulses."plot(dt_model)text(dt_model, use.n = TRUE)#the MSE is 46.3071 which is really high, model have significant error #second choose a representative from the fat_height_genetic #still choose those relevant dt_model <- rpart(Mean.height ~ Animal.Products + Cereals...Excluding.Beer +                     Wheat.and.products + Rice.and.products + Maize.and.products +                     Rye.and.products + Oats + Millet.and.products + Sorghum.and.products +                     Cereals..Other + Starchy.Roots + Cassava.and.products +                     Potatoes.and.products + Sweet.potatoes + Yams + Roots..Other +                     Sugar.Crops + Sugar.cane + Pulses + Beans + Peas +                     Pulses..Other.and.products + Treenuts + Nuts.and.products +                     Oilcrops + recessive + heterogeneous,                   data = fat_height_genetic,                  control = rpart.control(cp = 0.001, minsplit = 20))  summary(dt_model)#the result is ""heterogeneous" and "recessive," followed by "Starchy.Roots," #"Wheat.and.products," "Oilcrops," "Animal.Products," "Nuts.and.products," #"Treenuts," "Rye.and.products," "Oats," "Peas," "Maize.and.products," #"Cassava.and.products," and "Pulses." plot(dt_model)text(dt_model, use.n = TRUE)#the MSE is  really high, model have large significant error #thirdly the food_height_genetic #ignore the sex #still choose those relevant dt_model <- rpart(Mean.height ~ Barley.and.products + Maize.and.products + Rye.and.products +                     Oats + Millet.and.products + Sorghum.and.products + Cereals..Other +                     Starchy.Roots + Cassava.and.products + Potatoes.and.products +                     Yams + Roots..Other + Sugar.Crops + Sugar.cane +                     Sugar.non.centrifugal + Pulses + Beans + Peas +                     Pulses..Other.and.products + Treenuts + Nuts.and.products +                     Oilcrops + heterogeneous,                   data = food_height_genetic,                  control = rpart.control(cp = 0.001, minsplit = 20))summary(dt_model)#heterogeneous agricultural products, we have starchy roots, barley and its products, #pulses, beans, rye and its products, treenuts, pulses and other related products,#potatoes and their products, oats, nuts and products, and oilcrops. plot(dt_model)text(dt_model, use.n = TRUE)#consider sex #first maledt_model <- rpart(Mean.height ~ Wheat.and.products + Rice.and.products + Barley.and.products +                     Maize.and.products + Rye.and.products + Oats + Millet.and.products +                     Sorghum.and.products + Cereals..Other + Starchy.Roots +                     Cassava.and.products + Potatoes.and.products + Yams + Roots..Other +                     Sugar.Crops + Sugar.cane + Sugar.non.centrifugal + Pulses + Beans + Peas +                     Pulses..Other.and.products + Treenuts + Nuts.and.products + Oilcrops +                     recessive + heterogeneous,                   data = food_height_geneitc_male,                  control = rpart.control(cp = 0.001, minsplit = 20))summary(dt_model)#didn't show the importance variables plot(dt_model)text(dt_model, use.n = TRUE)#the tree splitting not very well#try the female one too dt_model <- rpart(Mean.height ~ Wheat.and.products + Rice.and.products + Barley.and.products +                     Maize.and.products + Rye.and.products + Oats + Millet.and.products +                     Sorghum.and.products + Cereals..Other + Starchy.Roots +                     Cassava.and.products + Potatoes.and.products + Yams + Roots..Other +                     Sugar.Crops + Sugar.cane + Sugar.non.centrifugal + Pulses + Beans + Peas +                     Pulses..Other.and.products + Treenuts + Nuts.and.products + Oilcrops +                     recessive + heterogeneous,                   data = food_height_geneitc_female,                  control = rpart.control(cp = 0.001, minsplit = 20))summary(dt_model)#didn't show the importance variables plot(dt_model)text(dt_model, use.n = TRUE)#the tree splitting not very well